{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-6">
        <h2>Agregar Nueva Opci√≥n al CHOICE.txt</h2>
        
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        <form method="post">
            {% csrf_token %}
            
            <div class="mb-3">
                {{ form.valor.label_tag }}
                {{ form.valor }}
                {% if form.valor.errors %}
                    <div class="text-danger">{{ form.valor.errors }}</div>
                {% endif %}
                <small class="form-text text-muted">Valor interno (sin espacios, min√∫sculas, solo letras, n√∫meros y _)</small>
            </div>

            <div class="mb-3">
                {{ form.etiqueta.label_tag }}
                {{ form.etiqueta }}
                {% if form.etiqueta.errors %}
                    <div class="text-danger">{{ form.etiqueta.errors }}</div>
                {% endif %}
                <small class="form-text text-muted">Texto visible para el usuario</small>
            </div>

            <button type="submit" class="btn btn-primary">Agregar Opci√≥n</button>
            <a href="{% url 'descargar_choice_txt' %}" class="btn btn-success">
                üì• Descargar CHOICE.txt
            </a>
            <a href="{% url 'ver_choice_txt' %}" class="btn btn-info">
                üëÄ Ver Contenido
            </a>
        </form>
    </div>

    <div class="col-md-6">
        <h3>Opciones Existentes ({{ opciones|length }})</h3>
        
        {% if opciones %}
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Valor</th>
                        <th>Etiqueta</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for opcion in opciones %}
                    <tr>
                        <td><code>{{ opcion.valor }}</code></td>
                        <td>{{ opcion.etiqueta }}</td>
                        <td>
                            <form method="post" action="{% url 'eliminar_opcion' opcion.valor %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm" 
                                        onclick="return confirm('¬øEliminar esta opci√≥n?')">
                                    üóëÔ∏è
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="alert alert-warning">
            No hay opciones registradas. ¬°Agrega la primera!
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}